
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
<script src="/static/jquery-ui-1.10.2.custom/js/jquery-1.9.1.js"></script>
<script type="text/javascript">
function sleep() {
  return;
}
    function doAjax() {
       $.ajax({
          type: "POST",
          url: "Default.aspx/GetStatus",
          data: "{}",
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          async: true,
          success: function (msg) {
             if (!msg.d)
                 setTimeout(doAjax, 2000);
             else {
                 // Success! Notify user here
             }
          },
          error: function (xhr, ajaxOptions, thrownError) {
            alert('AJAX failure');
          }
       });
    }

function get_data() {
  $.ajax({
      url: "/show/test_json",
      data: "{}",
      async: true,
      dataType: "json"
      ,success:function(resp){
        if (resp.done) {
          alert("Done!");
          $('#res').text("Done!!!!");
        }
        else {
            $('#res').append(JSON.stringify(resp));
            setTimeout(get_data, 2000);
        }
       },
       error: function (xhr, ajaxOptions, thrownError) {
         alert('AJAX failure');
         setTimeout(get_data, 2000);
       }
      });
}
$(document).ready(function(){ 
//DOCUMENT READY FUNCTION
  get_data();
}); 
</script>
</head>
<body >
<div id="res">
<input type="submit" onClick="get_data();"</div>
<script>
</script>
</body>
