{% extends 'logged_in_base.html' %}


{%block contents%}
{%load utilities%}
<div class="row margin-left-1">
  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <div class="box">
      <div class="box-header">
          <h3 class="box-title">GRIDCell Status</h3>
          <div class="box-tools pull-right">
              <button data-original-title="Collapse" class="btn btn-default btn-sm" data-widget="collapse" data-toggle="tooltip" title=""><i class="fa fa-minus"></i></button>
          </div>
      </div>
      <div class="box-body">
        {% if num_nodes_bad > 0 %} <i class="fa fa-bell faa-ring animated orange"></i> {{num_nodes_bad}} GRIDCell(s) have problems{%endif%}
        <p>
        <br />
          <table>
            <thead>
              <th> GRIDCell Name</th>
              <th> GRIDCell Status </th>
              <th> Pool Status </th>
            </thead>
            <tbody>
               {%for k,v in nodes.items%}
                <tr>
                    <td><a href="/show/node_status/{{k}}" class="text">{{k}}</a> </td>
                    <td> {%if v == 0%}<small class="label label-success white"><i class="fa fa-check-circle-o "></i> Online</small>{%else%}<small class="label label-danger white"><i class="fa fa-remove"></i> Degraded</small>{%endif%} </td>
                     <td> {%if storage_pool|get_item:k == "Peer in Cluster"%}<small class="label label-success white"><i class="fa fa-check-circle-o "></i> Healthy</small>{%else%}<small class="label label-danger white"><i class="fa fa-remove"></i> Offline</small>{%endif%} </td>
                {%endfor%}
              </tr>

            </tbody>
          </table>
        </p>
      </div><!-- /.box-body -->
      <div class="box-footer">
        <span class="pull-right">
          <a href="/show/gridcells" role="button" {%if num_nodes_bad > 0 %}class="btn btn-warning">More Details<i class="fa fa-bell-o"></i> {%else%}class="btn btn-success">More Details <i class="fa fa-arrow-right"></i>{%endif%} </a>
        </span>
      </div><!-- /.box-footer-->
    </div>
  </div>
</div>
<div class="row margin-left-1">
  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <div class="box">
      <div class="box-header">
          <h3 class="box-title">Volume Status</h3>
          <div class="box-tools pull-right">
              <button data-original-title="Collapse" class="btn btn-default btn-sm" data-widget="collapse" data-toggle="tooltip" title=""><i class="fa fa-minus"></i></button>
          </div>
      </div>
      <div class="box-body">
        {% if num_vols_bad > 0 %} <i class="fa fa-bell faa-ring animated orange"></i> {{num_vols_bad}} Volumes(s) have problems{%endif%}
        <div class="row">
          {% for v in volume_info_list %}
            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
              <div class="chart" data-percent="{{v.size_used_percent}}"></div>
              <span class="col-md-offset-4 col-lg-offset-4">&nbsp;&nbsp;&nbsp;<a href="/show/volume_info/{{v.name}}/"><div class="label label-info white">{{v.name}} &nbsp; {{v.size_used_percent}}%</div></a></span>
            </div>
          {%endfor%}
      </div>
      </div><!-- /.box-body -->
      <div class="box-footer">
          <a href="/show/volume_info_all" role="button" {%if num_vols_bad > 0 %}class="btn btn-warning">More Details<i class="fa fa-bell-o"></i> {%else%}class="btn btn-success">More Details <i class="fa fa-arrow-right"></i>{%endif%} </a>
      </div><!-- /.box-footer-->
    </div>
  </div>
</div>
<script type="text/javascript" src="/static/js/jquery.easypiechart.min.js"></script>
<link rel="stylesheet"type="text/css" href="/static/css/jquery.easy-pie-chart.css">

<script type="text/javascript">
$(function() {
    $('.chart').easyPieChart({
      barColor : function(percent){
                        if (percent <= 50)
                          return '#008D4C'
                        else if (percent >50 && percent <= 75)
                          return '#F39C12'
                        else
                          return '#F56954'
                      },
      lineCap : 'round',
      lineWidth : 5,
      trackColor: '#eee',
      animate : true,
      size : 100,
    });
});
</script>
{%endblock%}
{%block help_header%}
Dashboard
{%endblock%}
{%block help_body%}
<p>The IntegralView dashboard is a one stop page that gives you an overall view of the status and health of the IntegralStor system. From this page, you can get an idea of the health of each GRIDCell, the storage pool and of all the data volumes.</p>
{%endblock%}

{% block menu_active %}
<script>
  make_side_menu_active("dashboard_menu")
</script>
{% endblock%}
