{% extends 'system_log_base.html' %}

{%block tab_header%}
  {%if historical%} Historical {%endif%}Audit Trails
{%endblock%}

{%block inside_content%}

<br><br>

{% if audit_list %}
<table  class="table table-hover">
<thead>
<tr>
<th>
Time
</th>
<th>
Action
</th>
<th>
Details
</th>
<th>
Initiated from
</th>
</thead>
{%for d in audit_list %}
<tr>
  <td>
    {{d.time}}
  </td>
  <td>
    {{d.action}}
  </td>
  <td>
    {{d.action_str}}
  </td>
  <td>
    {% if d.ip == "0.0.0.0"%}
    Batch process
    {%else%}
    {{d.ip}}
    {%endif%}
  </td>
</tr>
{%endfor%}
</table>
{%else%}
No current audit trail entries to display.
{%endif%}
{%if audit_list and not historical%}
<a href="/rotate_log/audit_trail" class="btn btn-primary">Rotate Audit Logs </a>
{%endif%}
<br>
{% if historical %}
<a href="/view_rotated_log_list/audit_trail/" role="button" class="btn btn-primary">Back to log list</a>
{%endif%}


{%endblock%}
{%block help_header%}
Audit trail
{%endblock%}
{%block help_body%}
  <p>The IntegralView system keeps a record of all system modifications that have been done using Integral View. This audit trail page lists these actions along with the time when they were performed and the IP address from where the action was initiated. This can be used to track down potentially harmful actions.</p>
{%endblock%}
{% block tab_active %}
  <script>
    make_tab_active('system_log_view_current_audit_tab')
  </script>
{% endblock %}
