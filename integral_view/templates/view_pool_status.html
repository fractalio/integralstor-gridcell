{% extends 'logged_in_base.html' %}


{%block page-header%}
  Storage Pool Status
  <br /><small>
      Storage Pool 
      <i class="fa fa-angle-double-right smaller-80"></i>
      View Integral Stor Storage GRIDCells
  </small>
{%endblock%}


{%block contents%}
<script type="text/javascript">

function load_node_info(hostname, str) {
  url='/show/node_status/' + encodeURIComponent(hostname);
  document.getElementById('myModalLabel').innerHTML = "GRIDCell information for " + str ;
  //document.getElementById('myModalLabel').innerHTML = "GRIDCell information for " + str + "&nbsp; (" + hostname + ")";
  $('#myModalBody').load(url);
  $('#myModal').modal();
}
</script>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body" id="myModalBody">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>



<b> Storage GRIDCells in use </b>
<table class="table table-bordered table-condensed table-hover datatable" style="width:800px">
  <thead>
    <tr>
      <th>
        GRIDCell name
      </th>
      <th>
        <b>Status </b>
      </th>
      <th>
        GRIDCell details
      </th>
    </tr>
  </thead>
  <tbody>
    {% for hostname, d in system_info.items %}
      {% if d.node_status >= 0 %}
        {% if d.in_cluster %}
          {% if d.cluster_status != 1 %}
            <tr class="warning">
          {%else %}
            <tr>
          {%endif%}
              <td>
                {{hostname}}
              </td>
              <td>
                {% if d.cluster_status == 1 %}
                online
                {%else%}
                Offline
                {%endif%}
              </td>
              <td>
                {% if d.cluster_status == 1 %}
                <a href="/show/node_status/{{hostname}}/?from=pool_status" role="button" class="btn btn-default">GRIDCell info.. </a>
                {%else%}
                <a href="/show/node_status/{{hostname}}/?from=pool_status" role="button" class="btn btn-warning">GRIDCell info.. </a>
                {%endif%}
              </td>
            </tr>
        {%endif%}
      {%endif%}
    {%endfor%}
  </tbody>
</table>

{%if num_free_nodes > 0 %}
  <b> Storage GRIDCells not currently in use </b>


  <table class="table table-bordered table-condensed table-hover datatable" style="width:800px">
    <thead>
      <tr>
        <th>
          GRIDCell name
        </th>
        <th>
          GRIDCell details
        </th>
      </tr>
    </thead>
    <tbody>
      {% for hostname, d in system_info.items %}
        {% if d.node_status >= 0 %}
          {% if not d.in_cluster %}
              <tr>
                <td>
                  {{hostname}}
                </td>
                <td>
                  <a href="/show/node_status/{{hostname}}/?from=pool_status" role="button" class="btn btn-default">GRIDCell info.. </a>
                </td>
              </tr>
          {%endif%}
        {%endif%}
      {%endfor%}
    </tbody>
  </table>
{%else%}
  <b> All storage GRIDCells are currently in use. No free storage GRIDCells available. </b>
{%endif%}

{%endblock%}

{%block help_header%}
  Storage pool status
{%endblock%}

{%block help_body%}
  <p>Before any data volume can be placed on a GRIDCell, it first needs to be part of the storage pool. The storage pool provides a common name space across all GRIDCells. This requires communication and coordination between the GRIDCells that are part of this pool.</p><p> This page gives the storage pool status of each GRIDCell.</p>
{%endblock%}

