
import json, os

import integralstor_common
from integralstor_common import common

def load_all_files():
  list = []
  try:
    batch_dir, err = common.get_batch_files_path()
    if err:
      raise Exception(err)
    files = os.listdir(os.path.normpath("%s"%batch_dir))
    if files:
      for file in files:
        with open(os.path.normpath("%s/%s"%(batch_dir, file))) as f:
          #print "%s/%s"%(batch_dir, file)
          d = json.load(f)
          list.append(d)
  except Exception, e:
    return None, 'Error loading all batch files : %s'%str(e)
  else:
    return list, None

def load_specific_file(filename):

  # Return the json contents of the filename as the data structure
  d = None
  try:
    batch_dir, err = common.get_batch_files_path()
    if err:
      raise Exception(err)
    f = None
    f = open(os.path.normpath("%s/%s"%(batch_dir, filename)))
    if f:
      d = json.load(f)
  except Exception, e:
    return None, 'Error loading specific batch file : %s'%str(e)
  else:
    return d, None


